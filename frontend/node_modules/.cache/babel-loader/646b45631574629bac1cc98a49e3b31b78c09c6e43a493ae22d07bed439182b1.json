{"ast":null,"code":"import _regeneratorRuntime from\"/home/saymon/Backup/Portifolio/Hematology-App-with-Carbon-Design-System/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/saymon/Backup/Portifolio/Hematology-App-with-Carbon-Design-System/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/saymon/Backup/Portifolio/Hematology-App-with-Carbon-Design-System/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import{useNavigate}from\"react-router-dom\";import styles from\"./LoginPanel.module.scss\";import{Heading,Section,SideNav,Stack,Form}from\"@carbon/react\";import EmailInputField from\"../email-input/EmailInputField\";import PasswordInput from\"../password-input/PasswordInputField\";import{useLoginPanelStore}from\"../../store/useLoginPanelStore\";import{useToken}from\"../../hooks/useToken\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginPanel=function LoginPanel(){var _useToken=useToken(),_useToken2=_slicedToArray(_useToken,2),setToken=_useToken2[1];var navigate=useNavigate();var emailValue=useLoginPanelStore(function(_ref){var emailValue=_ref.emailValue;return emailValue;});var passwordValue=useLoginPanelStore(function(_ref2){var passwordValue=_ref2.passwordValue;return passwordValue;});var isEmailInputInvalid=useLoginPanelStore(function(_ref3){var isEmailInputInvalid=_ref3.isEmailInputInvalid;return isEmailInputInvalid;});var setIsPasswordFieldValid=useLoginPanelStore(function(_ref4){var setIsPasswordFieldValid=_ref4.setIsPasswordFieldValid;return setIsPasswordFieldValid;});var setWasPasswordFieldTouched=useLoginPanelStore(function(_ref5){var setWasPasswordFieldTouched=_ref5.setWasPasswordFieldTouched;return setWasPasswordFieldTouched;});var handleSubmit=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var credentials,response,_yield$response$json,access_token;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();if(!passwordValue){_context.next=16;break;}credentials={email:emailValue,password:passwordValue};_context.next=5;return fetch(\"http://\".concat(process.env.REACT_APP_API_DOMAIN,\":\").concat(process.env.REACT_APP_API_PORT,\"/auth/signin\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(credentials)});case 5:response=_context.sent;if(response.ok){_context.next=8;break;}throw\"Response isn't ok!\";case 8:_context.next=10;return response.json();case 10:_yield$response$json=_context.sent;access_token=_yield$response$json.access_token;setToken(access_token);navigate(\"/app\");_context.next=18;break;case 16:setIsPasswordFieldValid(false);setWasPasswordFieldTouched(true);case 18:case\"end\":return _context.stop();}},_callee);}));return function handleSubmit(_x){return _ref6.apply(this,arguments);};}();return/*#__PURE__*/_jsx(SideNav,{className:styles[\"side-nav\"],isFixedNav:true,expanded:true,isChildOfHeader:true,\"aria-label\":\"Side navigation\",children:/*#__PURE__*/_jsx(Form,{className:styles[\"form-container\"],method:\"post\",onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(Stack,{gap:4,children:[/*#__PURE__*/_jsx(Section,{level:3,children:/*#__PURE__*/_jsx(Heading,{className:styles[\"heading-font\"],children:\"Login\"})}),isEmailInputInvalid&&/*#__PURE__*/_jsx(EmailInputField,{}),!isEmailInputInvalid&&/*#__PURE__*/_jsx(PasswordInput,{})]})})});};export default LoginPanel;","map":{"version":3,"names":["React","useNavigate","styles","Heading","Section","SideNav","Stack","Form","EmailInputField","PasswordInput","useLoginPanelStore","useToken","jsx","_jsx","jsxs","_jsxs","LoginPanel","_useToken","_useToken2","_slicedToArray","setToken","navigate","emailValue","_ref","passwordValue","_ref2","isEmailInputInvalid","_ref3","setIsPasswordFieldValid","_ref4","setWasPasswordFieldTouched","_ref5","handleSubmit","_ref6","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","credentials","response","_yield$response$json","access_token","wrap","_callee$","_context","prev","next","preventDefault","email","password","fetch","concat","process","env","REACT_APP_API_DOMAIN","REACT_APP_API_PORT","method","headers","body","JSON","stringify","sent","ok","json","stop","_x","apply","arguments","className","isFixedNav","expanded","isChildOfHeader","children","onSubmit","gap","level"],"sources":["/home/saymon/Backup/Portifolio/Hematology-App-with-Carbon-Design-System/frontend/src/components/login-panel/LoginPanel.jsx"],"sourcesContent":["import React from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport styles from \"./LoginPanel.module.scss\";\nimport { Heading, Section, SideNav, Stack, Form } from \"@carbon/react\";\nimport EmailInputField from \"../email-input/EmailInputField\";\nimport PasswordInput from \"../password-input/PasswordInputField\";\nimport { useLoginPanelStore } from \"../../store/useLoginPanelStore\";\nimport { useToken } from \"../../hooks/useToken\";\n\nconst LoginPanel = () => {\n  const [, setToken] = useToken();\n  const navigate = useNavigate();\n  const emailValue = useLoginPanelStore(({ emailValue }) => emailValue);\n  const passwordValue = useLoginPanelStore(({ passwordValue }) => passwordValue);\n  const isEmailInputInvalid = useLoginPanelStore(({ isEmailInputInvalid }) => isEmailInputInvalid);\n  const setIsPasswordFieldValid = useLoginPanelStore(\n    ({ setIsPasswordFieldValid }) => setIsPasswordFieldValid,\n  );\n  const setWasPasswordFieldTouched = useLoginPanelStore(\n    ({ setWasPasswordFieldTouched }) => setWasPasswordFieldTouched,\n  );\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    if (passwordValue) {\n      const credentials = {\n        email: emailValue,\n        password: passwordValue,\n      };\n      const response = await fetch(\n        `http://${process.env.REACT_APP_API_DOMAIN}:${process.env.REACT_APP_API_PORT}/auth/signin`,\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify(credentials),\n        },\n      );\n      if (!response.ok) {\n        throw \"Response isn't ok!\";\n        // TODO: need to show a feedback on LoginPanel if get an error\n      }\n      const { access_token } = await response.json();\n      setToken(access_token);\n      navigate(\"/app\");\n    } else {\n      setIsPasswordFieldValid(false);\n      setWasPasswordFieldTouched(true);\n    }\n    // TODO: need to clean user and password variables after send request\n  };\n\n  return (\n    <SideNav\n      className={styles[\"side-nav\"]}\n      isFixedNav\n      expanded={true}\n      isChildOfHeader={true}\n      aria-label=\"Side navigation\">\n      <Form className={styles[\"form-container\"]} method=\"post\" onSubmit={handleSubmit}>\n        <Stack gap={4}>\n          <Section level={3}>\n            <Heading className={styles[\"heading-font\"]}>Login</Heading>\n          </Section>\n          {isEmailInputInvalid && <EmailInputField />}\n          {!isEmailInputInvalid && <PasswordInput />}\n        </Stack>\n      </Form>\n    </SideNav>\n  );\n};\nexport default LoginPanel;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}